---
layout: post
title: Mysql Sharding
description: 介绍Mysql Sharding的简单原则
category: blog
---

## 读写分离

使用主从数据库分离读写操作，需要前端服务配合，使用特定的数据库来读取数据，使用特定的数据库来写入操作
主数据库用来写入
从数据库用来读取

原因：

* 主数据库需要做备份更新，从数据库不需要做额外的备份更新
* DBA可以为主从分配不同的事务隔离策略
* Mysql可以对读操作可以做优化

从库在读操作时是否触发主库的写同步操作

### Atlas

atlas是360提供的数据库中间件，负责主从分离和表水平拆分工作

总体架构：如图

![atlas_framework](/images/atlas总体架构.png)

由atlas负责读写操作的分离，对调用方是透明的
如果遇到表水平拆分问题，需要谨慎使用

水平切分：数据按照一定的规则落到数据库实例上，规则有

* 区间规则: 例如(key在0..100落在实例1，101..200落在实例2,...依次类推)
* Hash规则：针对key做一致性Hash，选择候选节点




